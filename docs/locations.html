<!DOCTYPE html>
<html lang="en">
<head>
    <title>Oct 7 locations</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""></script>
    <link rel="icon" href="https://github.com/yuval-harpaz/alarms/blob/master/docs/logo.png?raw=true" type="image/x-icon"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
    #map{
        height: 100vh;
        width: 100vw;
    }
    #popup-message {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 255, 255, 0.95);
      padding: 12px 18px;
      border-radius: 8px;
      font-size: 1.2em;
      font-weight: 500;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 1000;
      direction: rtl;
      text-align: center;
      max-width: 400px;
      border: 2px solid #007bff;
    }

    #popup-message .close-btn {
      position: absolute;
      top: 5px;
      right: 8px;
      background: none;
      border: none;
      font-size: 1.5em;
      cursor: pointer;
      color: #666;
      line-height: 1;
    }

    #popup-message .close-btn:hover {
      color: #000;
    }

    #popup-message a {
      display: inline;
      font-size: 0.8em;
      color: #007bff;
      text-decoration: none;
    }
    
    #popup-message p {
      font-size: 0.7em;
      color: #333;
      margin: 8px 0;
      line-height: 1.3;
    }
    
    #popup-message a:hover {
      text-decoration: underline;
    }
    
    #search-box {
      position: absolute;
      top: 60px;
      left: 10px;
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      z-index: 1000;
      width: 250px;
    }
    
    #search-input {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 14px;
      direction: rtl;
      box-sizing: border-box;
    }
    
    #search-results {
      max-height: 300px;
      overflow-y: auto;
      margin-top: 5px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 4px;
      display: none;
    }
    
    .search-result-item {
      padding: 8px;
      cursor: pointer;
      border-bottom: 1px solid #eee;
      direction: rtl;
      text-align: right;
    }
    
    .search-result-item:hover {
      background: #f0f0f0;
    }
    
    .search-result-item:last-child {
      border-bottom: none;
    }
    .leaflet-tooltip-left:before {
        right: 0;
        margin-right: -12px;
        border-left-color: transparent;
    }
    .leaflet-tooltip-right:before {
        left: 0;
        margin-left: -12px;
        border-right-color: transparent;
    }
    .red-tooltip {
        background: transparent;
        box-shadow: none;
        border: transparent;
        color: red;
        font-weight: bold;
        font-size: 18px;
        line-height: 16px;
    }
    .blue-tooltip {
        background: transparent;
        box-shadow: none;
        border: transparent;
        color: blue;
        font-weight: bold;
        font-size: 18px;
        line-height: 16px;
        text-align: right;
    }
    </style>
</head>
<body>
    <div id="popup-message">
      <button class="close-btn" onclick="document.getElementById('popup-message').style.display='none'">&times;</button>
      מפת מיקומים של אירועי שבעה באוקטובר<br>
      <p>
      המפה כוללת מיקומים של אירועי רצח, חטיפה ונפילה בקרב של קורבנות שבעה באוקטובר.<br>
      פרטים נוספים באתר 
      </p><a href="https://oct7database.com/locations_intro.html" target="_blank">oct7database.com</a>
    </div>
    
    <div id="search-box">
      <input type="text" id="search-input" placeholder="חיפוש לפי שם או מקום...">
      <div id="search-results"></div>
    </div>
    <div id="map">
        <script type="module">
            const iconSize = 16;
            const redIcon = L.icon({
                iconUrl: 'https://yuval-harpaz.github.io/alarms/red_ring.png',
                iconSize: [iconSize, iconSize], // Set the size of the icon
                iconAnchor: [iconSize / 2, iconSize / 2], // Anchor the icon (centered in this example)
                popupAnchor: [0, 0] // Position of the popup relative to the icon
            });
            const blueIcon = L.icon({
                iconUrl: 'https://yuval-harpaz.github.io/alarms/blue_square.png',
                iconSize: [iconSize, iconSize], // Set the size of the icon
                iconAnchor: [iconSize / 2, iconSize / 2], // Anchor the icon (centered in this example)
                popupAnchor: [0, 0] // Position of the popup relative to the icon
            });
            const esri = L.tileLayer(
            "https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/WMTS/1.0.0/default028mm/MapServer/tile/49849/{z}/{y}/{x}",
            {
                attribution: "Esri, Maxar, Earthstar Geographics",
                maxNativeZoom: 18,
                maxZoom: 21,
                minZoom: 0,
                noWrap: false
            }
            );
            const esriLatest = L.tileLayer(
                "https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",
                {"attribution": "Esri", "detectRetina": false, "maxNativeZoom": 18, "maxZoom": 21, "minZoom": 0, "noWrap": false, "opacity": 1, "subdomains": "abc", "tms": false}
            )
            const govmap = L.tileLayer('https://cdnil.govmap.gov.il/xyz/heb/{z}/{x}/{y}.png', {
                maxZoom: 15,
                attribution: '© המרכז למיפוי ישראל www.govmap.gov.il',
            });
            var baseMaps = {
                "GovMap": govmap,
                "Esri latest": esriLatest,
                "Esri 2024-11-18": esri,
            };
            const map = L.map('map', {
                layers: [govmap, esriLatest, esri],
                center: [31.399114, 34.486369],
                // center: [31.52235270842099, 34.59410976761593],
                zoom: 15,
            });
            var geojsonData = {"type": "FeatureCollection", "features": [{"type": "Feature", "geometry": {"type": "Point", "coordinates": [34.33618, 31.24054]}, "properties": {"name": "\u05e0\u05d7\u05de\u05df \u05d3\u05e7\u05dc<br>\u05d2\u05dc\u05d9 \u05e9\u05e7\u05d5\u05ea\u05d0\u05d9<br>\u05d0\u05de\u05d9\u05e8 \u05dc\u05d1\u05d9\u05d0<br>\u05d0\u05d5\u05e4\u05d9\u05e8 \u05de\u05dc\u05de\u05df<br>\u05d8\u05dc \u05dc\u05d5\u05d9<br>\u05e2\u05de\u05d9\u05ea \u05de\u05d5\u05e1\u05d8", "event": "killed", "place_name": "\u05de\u05d5\u05e6\u05d1 \u05e1\u05d5\u05e4\u05d4", "link": "", "link_text": ""}}, {"type": "Feature", "geometry": {"type": "Point", "coordinates": [34.399661, 31.311162]}, "properties": {"name": "\u05e2\u05d3\u05d4 \u05e9\u05d2\u05d9\u05d0<br>\u05d0\u05d5\u05e4\u05dc\u05d9\u05d4 \u05e8\u05d5\u05d9\u05d8\u05de\u05df", "event": "kidnapped", "place_name": "\u05e0\u05d9\u05e8 \u05e2\u05d5\u05d6", "link": "https://nir-oz.org.il/every-house-has-a-story/", "link_text": "\u05dc\u05db\u05dc \u05d1\u05d9\u05ea \u05e1\u05d9\u05e4\u05d5\u05e8"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.489555, 31.425317], [34.490215, 31.425848], [34.490086, 31.426503], [34.489442, 31.42658], [34.488283, 31.425596], [34.488573, 31.425376], [34.489582, 31.425322]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05d0\u05d5\u05e8\u05e0\u05d9\u05dd", "details": "\u05d2\u05dc\u05d9\u05ea \u05de\u05d9\u05d9\u05d6\u05e0\u05e8 \u05e7\u05e8\u05d1\u05d5\u05e0\u05d4, \u05d7\u05d9\u05d9\u05dd \u05d6\u05d5\u05d4\u05e8, \u05e1\u05d5\u05d2\u05d9\u05d8 \u05e0\u05d9\u05e1\u05e0\u05e7\u05d4 \u05d9\u05d0\u05d8\u05d5\u05d5\u05d0\u05e8\u05d4"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.492511, 31.421101], [34.491888, 31.421632], [34.492232, 31.42193], [34.491942, 31.422355], [34.493423, 31.423504], [34.494399, 31.422731]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05d0\u05e9\u05dc\u05d9\u05dd", "details": "\u05d2\u05d0\u05d5\u05dc\u05d4 \u05d1\u05db\u05e8, \u05d7\u05d5\u05d4 \u05d1\u05df \u05e2\u05de\u05d9, \u05e4\u05e1\u05d9\u05d4 \u05db\u05d4\u05df, \u05e2\u05d3\u05d9 \u05d3\u05d2\u05df, \u05d6\u05d0\u05d1 \u05d4\u05e7\u05e8, \u05d6\u05d4\u05d1\u05d4 \u05d4\u05e7\u05e8, \u05e8\u05d5\u05e0\u05d9 \u05dc\u05d5\u05d9, \u05e8\u05e4\u05d0\u05dc \u05de\u05d5\u05e8\u05d3\u05d5, \u05d7\u05e0\u05d4 \u05e1\u05d9\u05d8\u05d5\u05df, \u05d9\u05e6\u05d7\u05e7 \u05e1\u05d9\u05d8\u05d5\u05df, \u05d8\u05dc \u05e1\u05d9\u05d8\u05d5\u05df, \u05d9\u05e0\u05d0\u05d9 \u05d7\u05e6\u05e8\u05d5\u05e0\u05d9 \u05d4\u05dc\u05e8, \u05d0\u05d9\u05d9\u05dc\u05d4 \u05d7\u05e6\u05e8\u05d5\u05e0\u05d9, \u05dc\u05d9\u05d0\u05dc \u05d7\u05e6\u05e8\u05d5\u05e0\u05d9 \u05d4\u05dc\u05e8, \u05d8\u05dc \u05db\u05e5"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.492511, 31.421101], [34.491888, 31.421632], [34.492232, 31.42193], [34.491942, 31.422355], [34.491207, 31.421998], [34.491261, 31.421028], [34.491776, 31.420437]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05d4\u05d4\u05d3\u05e8\u05d9\u05dd", "details": "\u05e0\u05e8\u05e7\u05d9\u05e1 \u05d4\u05e0\u05d3"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.487146, 31.421623], [34.487232, 31.424928], [34.488283, 31.425596], [34.488573, 31.425376], [34.487962, 31.421614]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05d4\u05d6\u05d9\u05ea\u05d9\u05dd", "details": "\u05e0\u05d4\u05e8\u05d2\u05d5: \u05d0\u05dc\u05d9\u05e8\u05df \u05d0\u05d1\u05e8\u05d2\u05f3\u05dc, \u05d9\u05d5\u05e1\u05d9 \u05d0\u05e4\u05d8\u05dc\u05d5\u05df, \u05d0\u05d1\u05e9\u05dc\u05d5\u05dd \u05d4\u05e8\u05df, \u05de\u05e2\u05d9\u05df \u05d1\u05e8, \u05d9\u05d5\u05d1\u05dc \u05d1\u05e8, \u05d8\u05dc \u05d1\u05d9\u05e8\u05d4, \u05d3\u05d5\u05d3 \u05e7\u05e8\u05d5\u05dc, \u05d9\u05d5\u05e0\u05d4 \u05db\u05d4\u05df, \u05d9\u05e6\u05d7\u05e7 \u05e7\u05d5\u05d6\u05d9\u05df, \u05de\u05e8\u05e1\u05dc \u05e4\u05e8\u05d9\u05d9\u05dc\u05d9\u05da \u05e7\u05e4\u05dc\u05d5\u05df, \u05db\u05e0\u05e8\u05ea \u05d2\u05ea, \u05d5\u05dc\u05e0\u05d8\u05d9\u05df \u05d2\u05e0\u05e1\u05d9\u05d4, \u05d0\u05d9\u05d9\u05dc\u05ea \u05d2\u05d5\u05d3\u05d0\u05e8\u05d3 \u05e4\u05e8\u05d2, \u05de\u05e0\u05d7\u05dd \u05d2\u05d5\u05d3\u05d0\u05e8\u05d3, \u05de\u05e2\u05d9\u05e0\u05d4 \u05d4\u05e8\u05e9\u05e7\u05d5\u05d1\u05d9\u05e5, \u05e0\u05d7 \u05d4\u05e8\u05e9\u05e7\u05d5\u05d1\u05d9\u05e5, \u05d9\u05d4\u05d5\u05d3\u05d9\u05ea \u05d9\u05e6\u05d7\u05e7\u05d9, \u05e8\u05d5\u05ea\u05dd \u05e7\u05dc\u05d3\u05e8\u05d5\u05df, \u05d3\u05e8\u05d5\u05e8 \u05e7\u05e4\u05dc\u05d5\u05df, \u05d0\u05e8\u05d9\u05d0\u05dc \u05d0\u05d5\u05d7\u05e0\u05d4, \u05e1\u05d9\u05dc\u05d1\u05d9\u05d4 \u05d0\u05d5\u05d7\u05d9\u05d5\u05df, \u05ea\u05de\u05d9 \u05e1\u05d5\u05db\u05de\u05df, \u05d0\u05d5\u05e8\u05d9\u05ea \u05e1\u05d1\u05d9\u05e8\u05e1\u05e7\u05d9 \u05e1\u05dc\u05e2, \u05e8\u05e4\u05d9 \u05e1\u05d1\u05d9\u05e8\u05e1\u05e7\u05d9, \u05e2\u05de\u05d9\u05e8 \u05d5\u05d9\u05d9\u05e1, \u05de\u05ea\u05d9 \u05d5\u05d9\u05d9\u05e1, \u05e0\u05d5\u05d4 \u05dc\u05e7\u05e1, \u05e9\u05d9\u05dc\u05d4 \u05db\u05d4\u05df, \u05d5\u05d9\u05d5\u05d9\u05d0\u05df \u05e1\u05d9\u05dc\u05d1\u05e8, \u05d9\u05d5\u05e0\u05d4 \u05e4\u05e8\u05d9\u05e7\u05e8<br>\u05e0\u05d7\u05d8\u05e4\u05d5: \u05e0\u05d5\u05e2\u05dd \u05d0\u05d1\u05d9\u05d2\u05d3\u05d5\u05e8\u05d9, \u05e9\u05e8\u05d5\u05df \u05d0\u05d1\u05d9\u05d2\u05d3\u05d5\u05e8\u05d9, \u05db\u05e8\u05de\u05dc \u05d2\u05ea, \u05d9\u05e8\u05d3\u05df \u05e8\u05d5\u05de\u05df-\u05d2\u05ea, \u05e2\u05d3\u05d9 \u05e9\u05d5\u05d4\u05dd, \u05d9\u05d4\u05dc \u05e9\u05d5\u05d4\u05dd, \u05e0\u05d5\u05d5\u05d4 \u05e9\u05d5\u05d4\u05dd, \u05d8\u05dc \u05e9\u05d5\u05d4\u05dd, \u05e9\u05d5\u05e9\u05df \u05d4\u05e8\u05df, \u05d0\u05d9\u05ea\u05d9 \u05e1\u05d1\u05d9\u05e8\u05e1\u05e7\u05d9"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.488573, 31.425376], [34.488069, 31.422461], [34.488739, 31.422406], [34.488734, 31.421659], [34.489394, 31.421664], [34.489415, 31.423321], [34.488911, 31.423376], [34.489324, 31.425326]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05d5\u05ea\u05d9\u05e7\u05d9\u05dd", "details": "\u05e0\u05d4\u05e8\u05d2\u05d5: \u05d7\u05d2\u05d9 \u05d0\u05d1\u05e0\u05d9, \u05d2\u05e8\u05d9\u05d9\u05e1 \u05e4\u05e8\u05d5\u05d3\u05d9\u05d2\u05d5 \u05e7\u05d1\u05e8\u05e8\u05d4, \u05de\u05d9\u05dc\u05d4 \u05db\u05d4\u05df, \u05d0\u05d1\u05d9\u05d4 \u05d7\u05e6\u05e8\u05d5\u05e0\u05d9, \u05e9\u05d5\u05e9\u05e0\u05d4 \u05db\u05e8\u05e1\u05e0\u05ea\u05d9, \u05e1\u05de\u05d9 \u05e7\u05d9\u05d3\u05e8, \u05de\u05e8\u05d3\u05db\u05d9 \u05e0\u05d5\u05d5\u05d4, \u05d0\u05d5\u05d4\u05d3 \u05db\u05d4\u05df, \u05d0\u05e0\u05d5\u05dc\u05d4 \u05e8\u05d8\u05e0\u05d0\u05d9\u05d9\u05e7\u05d4 \u05de\u05d5\u05d3\u05d9\u05d0\u05e0\u05e1, \u05dc\u05d9\u05d0\u05d5\u05e8 \u05d8\u05e8\u05e9\u05e6\u05f3\u05e0\u05e1\u05e7\u05d9, \u05d0\u05d4\u05d3 \u05db\u05d4\u05df, \u05d0\u05d1\u05e8\u05d4\u05dd \u05de\u05d5\u05e8<br>\u05e0\u05d7\u05d8\u05e4\u05d5: \u05e2\u05de\u05d9\u05ea \u05e9\u05e0\u05d9, \u05d2\u05dc\u05d9 \u05d8\u05e8\u05e9\u05e6\u05f3\u05e0\u05e1\u05e7\u05d9"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.491207, 31.421756], [34.490472, 31.421545], [34.489743, 31.421691], [34.489807, 31.422905], [34.489989, 31.423353], [34.49096, 31.423335]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05de\u05e8\u05db\u05d6", "details": "\u05ea\u05db\u05dc\u05ea \u05d6\u05e2\u05e8\u05d5\u05e8 \u05e4\u05d9\u05e9\u05d1\u05d9\u05d9\u05df, \u05d3\u05d5\u05e8 \u05e8\u05d9\u05d3\u05e8"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.489394, 31.421664], [34.489415, 31.423321], [34.488911, 31.423376], [34.489324, 31.425326], [34.490333, 31.425294], [34.490349, 31.424562], [34.489839, 31.424186], [34.490166, 31.423527], [34.489989, 31.423353], [34.489807, 31.422905], [34.489743, 31.421691]]]}, "properties": {"place_name": "\u05d1\u05d0\u05e8\u05d9; \u05e7\u05d5\u05de\u05d5\u05ea\u05d9\u05d9\u05dd", "details": "\u05e0\u05d4\u05e8\u05d2\u05d5: \u05d0\u05d3\u05e8\u05d9\u05d0\u05df \u05e0\u05d8\u05e2, \u05d9\u05d5\u05e8\u05dd \u05d1\u05e8 \u05e1\u05d9\u05e0\u05d9, \u05d0\u05dc\u05d1\u05e8\u05d8 \u05de\u05d9\u05dc\u05e1, \u05d9\u05d5\u05e0\u05ea\u05df \u05e8\u05e4\u05e4\u05d5\u05e8\u05d8, \u05e0\u05d5\u05d9 \u05e9\u05d5\u05e9, \u05d7\u05e0\u05d4 \u05e7\u05e8\u05d9\u05e6\u05de\u05df<br>\u05e0\u05d7\u05d8\u05e4\u05d5: \u05d0\u05d5\u05e4\u05d9\u05e8 \u05d0\u05e0\u05d2\u05dc, \u05d0\u05de\u05d9\u05dc\u05d9 \u05d4\u05e0\u05d3, \u05d9\u05d5\u05e1\u05e3 \u05e9\u05e8\u05e2\u05d1\u05d9, \u05d4\u05d9\u05dc\u05d4 \u05e8\u05d5\u05ea\u05dd \u05e9\u05d5\u05e9\u05e0\u05d9, \u05e8\u05e2\u05d9\u05d4 \u05e8\u05d5\u05ea\u05dd"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.325001, 31.232876], [34.323977, 31.233073], [34.32351, 31.231789], [34.324615, 31.231569]]]}, "properties": {"place_name": "\u05d7\u05d5\u05dc\u05d9\u05ea; \u05d5\u05ea\u05d9\u05e7\u05d9\u05dd", "details": "\u05dc\u05d9\u05d6 \u05d7\u05dc\u05e4\u05d5\u05df \u05d0\u05dc\u05d7\u05e8\u05e8, \u05de\u05d0\u05d9\u05e8 \u05d0\u05dc\u05d7\u05e8\u05e8, \u05dc\u05d9\u05dc\u05d9 \u05e7\u05d9\u05d9\u05e1\u05de\u05df, \u05e9\u05d7\u05e8 \u05de\u05ea\u05d9\u05d0\u05e1 \u05d8\u05e8\u05d5\u05d0\u05df, \u05e9\u05dc\u05d5\u05de\u05d9 \u05de\u05ea\u05d9\u05d0\u05e1, \u05e4\u05d3\u05e8\u05d5 \u05d1\u05d5\u05e1\u05e7\u05d5, \u05de\u05e9\u05d4 \u05e8\u05d9\u05d3\u05dc\u05e8, \u05e8\u05d5\u05dc\u05e0\u05d3 \u05e1\u05d5\u05dc\u05d8\u05df, \u05e8\u05d5\u05e0\u05d9\u05ea \u05d8\u05dc \u05e1\u05d5\u05dc\u05d8\u05df"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.32829, 31.232844], [34.32726, 31.233115], [34.32689, 31.232032], [34.327941, 31.231793]]]}, "properties": {"place_name": "\u05d7\u05d5\u05dc\u05d9\u05ea; \u05e6\u05e2\u05d9\u05e8\u05d9\u05dd", "details": "\u05e2\u05d3\u05d9 \u05d5\u05d9\u05d8\u05dc \u05e7\u05e4\u05dc\u05d5\u05df, \u05ea\u05d4\u05d9\u05dc\u05d4 \u05e7\u05e2\u05d8\u05d1\u05d9, \u05d7\u05d9\u05d9\u05dd \u05db\u05e6\u05de\u05df"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.39593, 31.375875], [34.396707, 31.374859], [34.396042, 31.374369], [34.39535, 31.374428], [34.395307, 31.374419]]]}, "properties": {"place_name": "\u05db\u05d9\u05e1\u05d5\u05e4\u05d9\u05dd; 21 \u05d0", "details": "\u05de\u05e0\u05d5\u05d7\u05d4 \u05d7\u05d5\u05dc\u05ea\u05d9, \u05d0\u05d9\u05d5\u05d5\u05df \u05d0\u05dc\u05e8\u05de\u05e0\u05d3\u05d9 \u05e1\u05d9\u05d6\u05e8, \u05d0\u05ea\u05d9 \u05d6\u05e7 \u05d1\u05df \u05d9\u05e2\u05d9\u05e9, \u05d0\u05d9\u05ea\u05d9 \u05d6\u05e7, \u05e9\u05d2\u05d9\u05d0 \u05d6\u05e7, \u05e1\u05e2\u05e8 \u05de\u05e8\u05d2\u05d5\u05dc\u05d9\u05e1, \u05d3\u05e4\u05e0\u05d4 \u05d2\u05e8\u05e7\u05d5\u05d1\u05d9\u05e5\u05f3 \u05d0\u05dc\u05e8\u05de\u05e0\u05d3\u05d9, \u05d0\u05d3\u05dd \u05d0\u05d2\u05de\u05d5\u05df"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.400393, 31.377162], [34.399824, 31.377776], [34.398934, 31.377199], [34.399604, 31.376814]]]}, "properties": {"place_name": "\u05db\u05d9\u05e1\u05d5\u05e4\u05d9\u05dd; 21 \u05d3", "details": "\u05ea\u05d5\u05dd \u05d2\u05d5\u05d3\u05d5"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.400393, 31.377162], [34.399604, 31.376814], [34.400119, 31.376136], [34.400908, 31.376594]]]}, "properties": {"place_name": "\u05db\u05d9\u05e1\u05d5\u05e4\u05d9\u05dd; 21 \u05d4", "details": "\u05e9\u05dc\u05de\u05d4 \u05de\u05e0\u05e6\u05d5\u05e8"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.396622, 31.376631], [34.396997, 31.375784], [34.395903, 31.375921]]]}, "properties": {"place_name": "\u05db\u05d9\u05e1\u05d5\u05e4\u05d9\u05dd; 21 \u05d5", "details": "\u05e2\u05d5\u05e4\u05e8 \u05e8\u05d5\u05df, \u05d7\u05e0\u05d4 \u05e1\u05de\u05d9\u05d0\u05d8\u05d9\u05e5"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.527159, 31.482537], [34.528168, 31.483274], [34.529514, 31.48181], [34.528747, 31.480845]]]}, "properties": {"place_name": "\u05db\u05e4\u05e8 \u05e2\u05d6\u05d4; \u05d4\u05e8\u05d7\u05d1\u05d4 \u05d9\u05e9\u05e0\u05d4", "details": "\u05ea\u05de\u05e8 \u05e4\u05dc\u05e9, \u05d0\u05d5\u05e8\u05dc\u05d9 \u05e4\u05d9\u05e0\u05e7\u05d5 \u05e9\u05d5\u05d5\u05e8\u05e6\u05de\u05df, \u05d3\u05d5\u05d3 \u05e9\u05d5\u05d5\u05e8\u05e6\u05de\u05df, \u05d9\u05d2\u05d0\u05dc \u05e4\u05dc\u05e9"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.533446, 31.480781], [34.531783, 31.48079], [34.530995, 31.481943], [34.532744, 31.482213]]]}, "properties": {"place_name": "\u05db\u05e4\u05e8 \u05e2\u05d6\u05d4; \u05e9\u05db\u05d5\u05e0\u05d4 \u05d3\u05e8\u05d5\u05de\u05d9\u05ea", "details": "\u05d3\u05e0\u05d9\u05d0\u05dc \u05e4\u05dc\u05d3, \u05d2\u05d9\u05dc\u05d4 \u05e4\u05dc\u05d3, \u05d9\u05d6\u05d4\u05e8 \u05e4\u05dc\u05d3, \u05ea\u05de\u05d9 \u05e4\u05dc\u05d2 \u05d6\u05d9\u05d5 \u05e0\u05d0\u05d5\u05e8, \u05d0\u05dc\u05d9\u05e7\u05d5 \u05e8\u05d9\u05d9\u05db\u05e0\u05e9\u05d8\u05d9\u05d9\u05df \u05d4\u05db\u05d4\u05df, \u05de\u05e8\u05d3\u05db\u05d9 \u05d0\u05de\u05d9\u05e8, \u05d0\u05d1\u05d9\u05d1 \u05d5\u05e8\u05d8\u05d4\u05d9\u05d9\u05dd, \u05d3\u05d5\u05e8\u05d9\u05ea \u05d5\u05e8\u05d8\u05d4\u05d9\u05d9\u05dd \u05d1\u05e8 \u05d0\u05d9\u05dc\u05df, \u05d0\u05d9\u05ea\u05df \u05d6\u05d9\u05d5, \u05d0\u05e8\u05df \u05d2\u05d5\u05e8\u05df, \u05d8\u05d5\u05d1\u05d4 \u05d2\u05d5\u05e8\u05df"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.529638, 31.486], [34.530888, 31.485346], [34.532669, 31.485708], [34.533125, 31.484491], [34.53033, 31.483388], [34.529799, 31.483539], [34.529595, 31.48386], [34.52908, 31.483983], [34.52908, 31.483983]]]}, "properties": {"place_name": "\u05db\u05e4\u05e8 \u05e2\u05d6\u05d4; \u05e9\u05db\u05d5\u05e0\u05d4 \u05e6\u05e4\u05d5\u05e0\u05d9\u05ea", "details": "\u05e0\u05d4\u05e8\u05d2\u05d5: \u05d2\u05d9\u05d0 \u05d0\u05d3\u05de\u05d5\u05e0\u05d9, \u05de\u05d9\u05db\u05dc \u05d0\u05d3\u05de\u05d5\u05e0\u05d9, \u05d4\u05d3\u05e8 \u05d1\u05e8\u05d3\u05d9\u05e6\u05f3\u05e1\u05e7\u05d9 \u05e8\u05d5\u05d6\u05e0\u05e4\u05dc\u05d3, \u05d0\u05d9\u05ea\u05d9 \u05d1\u05e8\u05d3\u05d9\u05e6\u05f3\u05e1\u05e7\u05d9, \u05e9\u05d7\u05e3 \u05d1\u05e8\u05d2\u05e9\u05d8\u05d9\u05d9\u05df, \u05e0\u05e2\u05de\u05d9 \u05d3\u05d2\u05e0\u05d9, \u05d9\u05dd \u05d2\u05d5\u05dc\u05d3\u05e9\u05d8\u05d9\u05d9\u05df \u05d0\u05dc\u05de\u05d5\u05d2, \u05e0\u05d3\u05d1 \u05d2\u05d5\u05dc\u05d3\u05e9\u05d8\u05d9\u05d9\u05df \u05d0\u05dc\u05de\u05d5\u05d2, \u05e2\u05d5\u05de\u05e8 \u05d7\u05e8\u05de\u05e9, \u05dc\u05d9\u05dc\u05d9 \u05d0\u05d9\u05ea\u05de\u05e8\u05d9, \u05e8\u05dd \u05d0\u05d9\u05ea\u05de\u05e8\u05d9, \u05d0\u05d1\u05d9\u05d1 \u05e7\u05d5\u05e5, \u05dc\u05d9\u05d1\u05e0\u05ea \u05e7\u05d5\u05e5, \u05e8\u05d5\u05ea\u05dd \u05e7\u05d5\u05e5, \u05d9\u05e4\u05ea\u05d7 \u05e7\u05d5\u05e5, \u05d9\u05d5\u05e0\u05ea\u05df \u05e7\u05d5\u05e5, \u05de\u05d9\u05e8\u05d4 \u05e9\u05d8\u05d4\u05dc \u05d5\u05d9\u05d9\u05e1\u05d1\u05d5\u05da, \u05d0\u05dc\u05d9\u05d4\u05d5 \u05d0\u05d5\u05e8\u05d2\u05d3 \u05d2\u05d5\u05dc\u05d3\u05d1\u05e8\u05d2, \u05e0\u05d9\u05e8\u05d4 \u05e8\u05d5\u05e0\u05df, \u05e2\u05d5\u05de\u05e8 \u05e6\u05d3\u05d9\u05e7\u05d1\u05d9\u05e5\u05f3, \u05d1\u05dc\u05d4\u05d4 \u05d0\u05e4\u05e9\u05d8\u05d9\u05d9\u05df, \u05de\u05d0\u05d9\u05d4 \u05d1\u05df \u05d3\u05d5\u05d3 \u05d2\u05f3\u05d9\u05d1\u05dc\u05d9, \u05d0\u05e0\u05d2\u05f3\u05dc\u05d9\u05df \u05d0\u05d2\u05d9\u05e8\u05d4<br>\u05e0\u05d7\u05d8\u05e4\u05d5: \u05d0\u05d2\u05dd \u05d2\u05d5\u05dc\u05d3\u05e9\u05d8\u05d9\u05d9\u05df \u05d0\u05dc\u05de\u05d5\u05d2, \u05d7\u05df \u05d2\u05d5\u05dc\u05d3\u05e9\u05d8\u05d9\u05d9\u05df \u05d0\u05dc\u05de\u05d5\u05d2, \u05d2\u05dc \u05d2\u05d5\u05dc\u05d3\u05e9\u05d8\u05d9\u05d9\u05df \u05d0\u05dc\u05de\u05d5\u05d2, \u05d8\u05dc \u05d2\u05d5\u05dc\u05d3\u05e9\u05d8\u05d9\u05d9\u05df \u05d0\u05dc\u05de\u05d5\u05d2, \u05d0\u05d1\u05d9\u05d2\u05d9\u05dc \u05e2\u05d9\u05d3\u05df, \u05d0\u05d1\u05d9\u05d1\u05d4 \u05e1\u05d9\u05d2\u05dc, \u05e7\u05d9\u05ea \u05e1\u05d9\u05d2\u05dc, \u05d4\u05d2\u05e8 \u05d1\u05e8\u05d5\u05d3\u05e5, \u05e2\u05e4\u05e8\u05d9 \u05d1\u05e8\u05d5\u05d3\u05e5, \u05d0\u05d5\u05e8\u05d9\u05d4 \u05d1\u05e8\u05d5\u05d3\u05e5, \u05d9\u05d5\u05d1\u05dc \u05d1\u05e8\u05d5\u05d3\u05e5"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.403976, 31.306532], [34.403418, 31.308933], [34.405392, 31.308897], [34.405521, 31.306678]]]}, "properties": {"place_name": "\u05e0\u05d9\u05e8 \u05e2\u05d5\u05d6; \u05de\u05e9\u05e7", "details": "\u05d0\u05dc\u05d9\u05d4\u05d5 \u05de\u05e8\u05d2\u05dc\u05d9\u05ea"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.391837, 31.334679], [34.392459, 31.334853], [34.393687, 31.334903], [34.396761, 31.334908], [34.397099, 31.33494], [34.398606, 31.335302], [34.39896, 31.336356], [34.397346, 31.338944], [34.394921, 31.339531], [34.392534, 31.338527], [34.390136, 31.33685], [34.391799, 31.334702]]]}, "properties": {"place_name": "\u05e0\u05d9\u05e8\u05d9\u05dd", "details": "\u05e0\u05d4\u05e8\u05d2\u05d5: \u05d0\u05d5\u05e8\u05df \u05d0\u05dc\u05e4\u05e1\u05d9, \u05d2\u05d3\u05e2\u05d5\u05df \u05d1\u05d0\u05d1\u05d0\u05e0\u05d9, \u05de\u05d5\u05e8 \u05de\u05d0\u05d9\u05e8, \u05d3\u05d5\u05e8\u05d5\u05df \u05de\u05d0\u05d9\u05e8, \u05e8\u05d5\u05e2\u05d9 \u05e4\u05d5\u05e4\u05dc\u05d5\u05d5\u05dc, \u05ea\u05d5\u05de\u05e8 \u05d0\u05d7\u05d9\u05de\u05e1, \u05e7\u05d9\u05e8\u05d9\u05dc \u05d1\u05e8\u05d5\u05d3\u05e1\u05e7\u05d9, \u05d0\u05e1\u05e3 \u05d7\u05de\u05de\u05d9<br>\u05e0\u05d7\u05d8\u05e4\u05d5: \u05d7\u05e0\u05d4 \u05e4\u05e8\u05d9, \u05e0\u05d3\u05d1 \u05e4\u05d5\u05e4\u05dc\u05d5\u05d5\u05dc, \u05d9\u05d2\u05d1 \u05d1\u05d5\u05db\u05e9\u05d8\u05d1, \u05e8\u05d9\u05de\u05d5\u05df \u05e7\u05d9\u05e8\u05e9\u05d8 \u05d1\u05d5\u05db\u05e9\u05d8\u05d1, \u05e0\u05d5\u05e8\u05dc\u05d9\u05df \u05d1\u05d1\u05d3\u05d9\u05dc\u05d4 "}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.539632, 31.574678], [34.541885, 31.573888], [34.543338, 31.575588], [34.541863, 31.57652], [34.541209, 31.577685], [34.539766, 31.577123], [34.5402, 31.576159], [34.540265, 31.575766]]]}, "properties": {"place_name": "\u05e0\u05ea\u05d9\u05d1 \u05d4\u05e2\u05e9\u05e8\u05d4; \u05e9\u05db\u05d5\u05e0\u05d4 \u05e6\u05e4\u05d5\u05e0\u05d9\u05ea", "details": "\u05d0\u05e8\u05d9\u05d4 \u05d0\u05e7\u05d5\u05e0\u05d9, \u05d0\u05d5\u05e8 \u05d0\u05e7\u05d5\u05e0\u05d9, \u05d0\u05e8\u05dc\u05d8 \u05d0\u05e7\u05d5\u05e0\u05d9"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.588641, 31.420249], [34.587214, 31.41905], [34.582568, 31.422978], [34.58406, 31.424269], [34.585176, 31.423252], [34.584779, 31.422868], [34.586248, 31.421504], [34.586731, 31.421925]]]}, "properties": {"place_name": "\u05e0\u05ea\u05d9\u05d1\u05d5\u05ea; \u05e7\u05e8\u05d9\u05d9\u05ea \u05de\u05e9\u05d4", "details": "\u05e8\u05e4\u05d0\u05dc \u05e4\u05d4\u05d9\u05de\u05d9, \u05e0\u05ea\u05e0\u05d0\u05dc \u05de\u05e1\u05e7\u05d0\u05dc\u05e6\u05f3\u05d9, \u05e8\u05e4\u05d0\u05dc \u05de\u05e1\u05e7\u05d0\u05dc\u05e6\u05f3\u05d9"}}, {"type": "Feature", "geometry": {"type": "Polygon", "coordinates": [[[34.399406, 31.348158], [34.40477, 31.352519], [34.401326, 31.354242], [34.39815, 31.352345], [34.398569, 31.35076], [34.399384, 31.348075]]]}, "properties": {"place_name": "\u05e2\u05d9\u05df \u05d4\u05e9\u05dc\u05d5\u05e9\u05d4", "details": "\u05e0\u05d5\u05e2\u05d4 \u05d2\u05dc\u05d6\u05d1\u05e8\u05d2, \u05de\u05e8\u05e1\u05dc \u05d8\u05dc\u05d9\u05d4, \u05e1\u05d9\u05dc\u05d1\u05d9\u05d4 \u05de\u05d9\u05e8\u05e0\u05e1\u05e7\u05d9, \u05e8\u05dd \u05e0\u05d2\u05d1\u05d9"}}]}
var Areas = L.layerGroup()
            var allFeatures = []; // Store all features with their layer objects
            
            for (let i = 0; i < geojsonData['features'].length; i++) {
                const feat = geojsonData['features'][i];
                if (feat['geometry']['type'] !== 'Polygon') continue;
                console.log('Processing polygon feature:', feat);
                // Convert coordinates from [lng, lat] to [lat, lng] for Leaflet
                const coords = feat['geometry']['coordinates'][0].map(coord => [coord[1], coord[0]]);
                console.log('Converted coordinates:', coords);
                const pol = L.polygon(coords, { fillColor: '#ff69b4',
                        weight: 2,
                        opacity: 1,
                        color: '#ff1493',
                        dashArray: '3',
                        fillOpacity: 0.3})
                console.log('Created polygon:', pol);
                pol.bindPopup('<div dir="rtl" style="text-align: right;">' + feat['properties'].place_name + '<br>' + feat['properties'].details + '</div>');
                pol.addTo(Areas);
                allFeatures.push({
                    name: feat['properties'].place_name,
                    details: feat['properties'].details, // Store details for searching
                    type: 'polygon',
                    layer: pol,
                    feature: feat
                });
                console.log('Added polygon to Areas layer');
            }
            var Killed = L.layerGroup()
            var Kidnapped = L.layerGroup()
            for (let i = 0; i < geojsonData['features'].length; i++) {
                const feat = geojsonData['features'][i];
                if (feat['geometry']['type'] !== 'Point') continue;
                event = feat['properties'].event
                if (event === "killed") {
                    const marker = L.marker(feat['geometry']['coordinates'].reverse(), { icon: redIcon })
                    marker.bindTooltip(feat['properties'].name, {
                        permanent: true,
                        direction: 'right',
                        className: 'red-tooltip'
                    });
                    marker.bindPopup(feat['properties'].place_name + '<br>' + '<a href="' + feat['properties'].link + '" target="_blank">' + feat['properties'].link_text + '</a>');
                    marker.addTo(Killed)
                    allFeatures.push({
                        name: feat['properties'].name,
                        place: feat['properties'].place_name,
                        type: 'point',
                        event: 'killed',
                        layer: marker,
                        feature: feat
                    });
                } else if (event === "kidnapped") {
                    const marker = L.marker(feat['geometry']['coordinates'].reverse(), { icon: blueIcon })
                    marker.bindTooltip(feat['properties'].name, {
                        permanent: true,
                        direction: 'left',
                        className: 'blue-tooltip'
                    });
                    marker.bindPopup(feat['properties'].place_name + '<br>' + '<a href="' + feat['properties'].link + '" target="_blank">' + feat['properties'].link_text + '</a>');
                    marker.addTo(Kidnapped)
                    allFeatures.push({
                        name: feat['properties'].name,
                        place: feat['properties'].place_name,
                        type: 'point',
                        event: 'kidnapped',
                        layer: marker,
                        feature: feat
                    });
                }  else {
                    console.log('Unknown event: ', event)
                }
            }
            var overlayMaps = {
                "Area": Areas,
                "Killed": Killed,
                "Kidnapped": Kidnapped
            };
            Areas.addTo(map)
            Killed.addTo(map)
            Kidnapped.addTo(map)
            console.log('okay')
            var layerControl = L.control.layers(baseMaps, overlayMaps).addTo(map);
            document.getElementById('map').style.cursor = 'crosshair'
            map.on("contextmenu", function (event) {
                const coords = event.latlng.toString().slice(7, -1);

                // Try to copy to clipboard
                navigator.clipboard.writeText(coords).then(() => {
                    alert("Coordinates copied to clipboard:\n" + coords);
                }).catch(err => {
                    console.error("Could not copy text: ", err);
                    // Fallback to prompt
                    window.prompt("Copy to clipboard: Ctrl+C, Enter", coords);
                });
            });
            
            // Search functionality
            const searchInput = document.getElementById('search-input');
            const searchResults = document.getElementById('search-results');
            
            // Function to normalize text for searching
            function normalizeText(text) {
                if (!text) return '';
                return text
                    .normalize('NFD') // Decompose combined characters
                    .replace(/[\u0300-\u036f\u0591-\u05C7]/g, '') // Remove diacritics and Hebrew cantillation/vowels
                    .replace(/[׳״\u05F3\u05F4]/g, '') // Remove geresh and gershayim
                    .replace(/[^\u0590-\u05FF\u0600-\u06FF\w\s]/g, '') // Keep Hebrew, Arabic, alphanumeric and spaces
                    .toLowerCase();
            }
            
            searchInput.addEventListener('input', function() {
                const query = this.value.trim();
                
                if (query.length < 2) {
                    searchResults.style.display = 'none';
                    searchResults.innerHTML = '';
                    return;
                }
                
                const normalizedQuery = normalizeText(query);
                
                // Filter features by name, place, or details
                const matches = allFeatures.filter(item => {
                    const normalizedName = normalizeText(item.name);
                    const normalizedPlace = normalizeText(item.place);
                    const normalizedDetails = normalizeText(item.details);
                    const nameMatch = normalizedName.includes(normalizedQuery);
                    const placeMatch = normalizedPlace.includes(normalizedQuery);
                    const detailsMatch = normalizedDetails.includes(normalizedQuery);
                    return nameMatch || placeMatch || detailsMatch;
                });
                
                if (matches.length === 0) {
                    searchResults.style.display = 'none';
                    searchResults.innerHTML = '';
                    return;
                }
                
                // Display results
                searchResults.innerHTML = '';
                searchResults.style.display = 'block';
                
                matches.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'search-result-item';
                    
                    if (item.type === 'polygon') {
                        // For polygons, try to find the specific matched name
                        let matchedName = '';
                        if (item.details) {
                            // Split by <br> and then by ", " to get individual names
                            const detailsParts = item.details.split('<br>');
                            for (let part of detailsParts) {
                                // Extract names after "נהרגו:" or "נחטפו:"
                                const colonIndex = part.indexOf(':');
                                if (colonIndex !== -1) {
                                    const namesList = part.substring(colonIndex + 1).trim();
                                    const names = namesList.split(', ');
                                    for (let name of names) {
                                        const normalizedName = normalizeText(name.trim());
                                        if (normalizedName.includes(normalizedQuery)) {
                                            matchedName = name.trim();
                                            break;
                                        }
                                    }
                                }
                                if (matchedName) break;
                            }
                        }
                        
                        if (matchedName) {
                            div.textContent = `${matchedName} - ${item.name}`;
                        } else {
                            div.textContent = item.name;
                        }
                    } else {
                        const displayName = item.name.replace(/<br>/g, '; ');
                        div.textContent = `${displayName} - ${item.place}`;
                    }
                    
                    div.addEventListener('click', function() {
                        // Focus on the selected feature
                        if (item.type === 'polygon') {
                            map.fitBounds(item.layer.getBounds());
                        } else {
                            map.setView(item.layer.getLatLng(), 17);
                        }
                        
                        // Open popup
                        item.layer.openPopup();
                        
                        // Clear search
                        searchInput.value = '';
                        searchResults.style.display = 'none';
                        searchResults.innerHTML = '';
                    });
                    
                    searchResults.appendChild(div);
                });
            });
            
            // Close search results when clicking outside
            document.addEventListener('click', function(event) {
                if (!document.getElementById('search-box').contains(event.target)) {
                    searchResults.style.display = 'none';
                }
            });    
        </script>
    </div>
</body>
<!-- public map -->
</html>

